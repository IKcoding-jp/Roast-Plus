---
alwaysApply: true
---

# 機能

## 欠点豆図鑑

### 機能概要
- マスターデータとユーザー追加データの両方を表示
- 検索機能（名称、特徴、味への影響、省く理由で検索）
- フィルタ機能（全て、省く設定、省かない設定）
- 比較機能（複数の欠点豆を選択して比較表示）
- 画像アップロード機能（Firebase Storageを使用）
- 省く/省かない設定の管理

### マルチデバイス整合性のポイント
- 欠点豆マスターデータは `/defectBeans` コレクションに保存（全ユーザー共通）
- ユーザー追加欠点豆は `AppData.defectBeans` に保存（ユーザーごと）
- 欠点豆設定は `AppData.defectBeanSettings` に保存（ユーザーごと）
- 画像は Firebase Storage に保存（`defect-beans/{userId}/{defectBeanId}` パス）
- 設定の変更は、Firestore に即座に反映し、`onSnapshot` により全デバイス間で同期

## 作業進捗管理

### 機能概要
- 作業進捗の作成、更新、削除
- 進捗状態の管理（pending、in_progress、completed）
- 目標量と現在の進捗量の管理
- 完成数の管理（目標量がない場合も記録可能）
- 進捗履歴の記録（日付、進捗量、メモ）
- グループ化機能（groupNameでグループ化）

### マルチデバイス整合性のポイント
- 進捗状態の自動変更ロジック（pending → in_progress → completed）は、Firestore の値を基準に判定
- 進捗履歴の記録（`ProgressEntry`）は、サーバータイムスタンプを使用して日付の整合性を保つ
- 複数デバイスから同時に進捗を更新する可能性があるため、トランザクションの使用を検討
- 進捗量の更新は、1回の書き込みで「現在の進捗量＋履歴エントリ」まで反映

## ローストタイマー

### 機能概要
- タイマーの開始、一時停止、再開、リセット
- タイマー音と通知音の設定
- ロースト記録の保存（豆の名前、重さ、焙煎度合い、実際のロースト時間）
- マルチデバイス同期（複数デバイス間でタイマー状態を同期）
- 通知機能（タイマー完了時の通知）

### マルチデバイス整合性のポイント
- マルチデバイス同期を考慮（`RoastTimerState`の`triggeredByDeviceId`、`completedByDeviceId`）
- タイマー状態は Firestore に保存され、`onSnapshot` により全デバイス間で同期
- タイマーの開始・一時停止・再開・リセットは、Firestore に即座に反映
- タイマー音と通知音の設定（`RoastTimerSettings`）は、Firestore に保存され、全デバイス間で同期
- ロースト記録の保存（`RoastTimerRecord`）は、サーバータイムスタンプを使用して日付の整合性を保つ
- 複数デバイスから同時にタイマーを操作する可能性があるため、トランザクションの使用を検討

## 試飲記録

### 機能概要
- 試飲セッションの作成、編集、削除
- 試飲記録の作成、編集、削除
- 評価項目（苦味、酸味、ボディ、甘み、香り、総合評価）の記録（1.0〜5.0、0.125刻み）
- レーダーチャート表示
- セッションごとの記録一覧表示

### マルチデバイス整合性のポイント
- 試飲セッション（`TastingSession`）と試飲記録（`TastingRecord`）は、Firestore に保存され、`onSnapshot` により全デバイス間で同期
- 評価項目の更新は、1回の書き込みで反映
- 複数デバイスから同時に記録を更新する可能性があるため、トランザクションの使用を検討

## チーム・メンバー管理

### 機能概要
- チームの作成、編集、削除
- メンバーの作成、編集、削除
- タスクラベルの管理
- 割り当て機能

### マルチデバイス整合性のポイント
- チーム・メンバー・タスクラベルの変更は、Firestore に即座に反映
- 割り当て（`Assignment`）の変更は、全デバイス間で同期
- チーム削除時は、関連するメンバーと割り当ても削除（トランザクションを使用）

## スケジュール管理

### 機能概要
- 本日のスケジュール（`TodaySchedule`）の管理
- ローストスケジュール（`RoastSchedule`）の管理

### マルチデバイス整合性のポイント
- スケジュールの変更は、Firestore に即座に反映
- 日付の判定は、Firestore に保存された日付を基準にする（ローカル時間を使用しない）
- 複数デバイスから同時にスケジュールを更新する可能性があるため、トランザクションの使用を検討
