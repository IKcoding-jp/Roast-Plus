<!-- d016f209-70d7-4f73-98cb-2d96861bc500 a8d0f671-d246-4082-aece-f5a143224836 -->
# 管理者選択時の記録機能修正

## 問題の概要

デバイス使用者設定で管理者を選択している場合、以下の問題が発生しています：

1. 「この機能を使用するには、設定画面からデバイス使用者を設定する必要があります。」という警告が表示され、記録が作成できない
2. 記録数の表示（例：1/6）に管理者が含まれていない

## 原因

- `TastingRecordForm.tsx`で`selectedMemberId`のみをチェックしており、`selectedManagerId`が考慮されていない
- `activeMemberCount`の計算に管理者が含まれていない

## 修正内容

### 1. `components/TastingRecordForm.tsx`の修正

- `selectedMemberId`が空の場合、`selectedManagerId`もチェックして管理者IDを取得
- 警告表示の条件を修正：`selectedMemberId`または`selectedManagerId`のいずれかが設定されている場合は警告を非表示
- 記録保存時に、管理者が選択されている場合は管理者IDを`memberId`として使用

### 2. `lib/tastingUtils.ts`の修正

- `getActiveMemberCount`関数を修正して、管理者が存在する場合は+1する
- または、新しい関数`getActiveParticipantCount`を作成して、メンバー数+管理者（存在する場合）を返す

### 3. `components/TastingSessionList.tsx`の修正

- `activeMemberCount`の計算を新しい関数に置き換え（または修正された関数を使用）

## 実装詳細

### `components/TastingRecordForm.tsx`

- 65行目付近：`selectedMemberId`の取得ロジックを修正し、`selectedManagerId`も考慮
- 68行目付近：`memberId`の決定ロジックを修正
- 156行目付近：`finalMemberId`の取得ロジックを修正
- 328行目付近：警告表示の条件を修正

### `lib/tastingUtils.ts`

- `getActiveMemberCount`関数を修正、または新しい関数`getActiveParticipantCount`を追加
- 管理者が存在する場合（`data.manager`が存在する場合）は+1する

### `components/TastingSessionList.tsx`

- 40行目：`getActiveMemberCount`を`getActiveParticipantCount`に置き換え（または修正された関数を使用）

### To-dos

- [ ] TastingRecordForm.tsxでselectedManagerIdを考慮し、管理者選択時も記録を作成できるように修正
- [ ] lib/tastingUtils.tsでactiveMemberCountの計算に管理者を含めるように修正
- [ ] TastingSessionList.tsxで修正された関数を使用するように更新