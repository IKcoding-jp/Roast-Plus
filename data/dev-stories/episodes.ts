import type { DevStoryEpisode } from '@/types';

// 開発秘話エピソード
export const DEV_STORY_EPISODES: DevStoryEpisode[] = [
  {
    id: 'episode-001',
    title: 'ローストプラス誕生秘話',
    subtitle: 'アプリ開発のきっかけ',
    imageUrl: '/dev-stories/roast_plus_origin.png',
    dialogues: [
      {
        id: 'msg-001-1',
        characterId: 'asairi',
        content: 'ねえねえ、ローストプラスってどうして作ろうと思ったの？',
      },
      {
        id: 'msg-001-2',
        characterId: 'fukairi',
        content: '実は担当表のマンネリ化が課題だったんだ。\n掃除とローストの担当を6人で回してたんだけどね。',
      },
      {
        id: 'msg-001-3',
        characterId: 'asairi',
        content: 'マンネリ化？どういうこと？',
      },
      {
        id: 'msg-001-4',
        characterId: 'fukairi',
        content: '2列3行の担当表があって、左の列は上に、右の列は下にずらすっていうルールでシャッフルしてたんだ。',
      },
      {
        id: 'msg-001-5',
        characterId: 'asairi',
        content: 'あー、それだと同じペアになっちゃうってこと？',
      },
      {
        id: 'msg-001-6',
        characterId: 'fukairi',
        content: 'そうそう！3日経つと元の組み合わせに戻っちゃうんだよね。\n周期的なパターンになって、特定の人に偏りがちだった。',
      },
      {
        id: 'msg-001-7',
        characterId: 'asairi',
        content: 'なるほど〜！それでランダムにシャッフルできる機能が欲しくなったんだね！',
      },
      {
        id: 'msg-001-8',
        characterId: 'fukairi',
        content: 'うん。ランダムだけじゃなくて、公平性も大事でね。\n誰かに偏らず、みんなが平等に担当できるアプリを作りたかったんだ。',
      },
    ],
    detailContent: `ローストプラスは、担当表運用の課題を解決するために生まれました。

## 従来の課題

6人で掃除・ローストの担当を回していましたが、以下の問題がありました：

- **固定的なシャッフルルール**: 2列3行の担当表を「左は上に、右は下に」というルールでシャッフルしていた
- **周期問題**: 3日後には同じペアの組み合わせに戻ってしまう
- **偏りの発生**: 特定の人が同じ担当になりやすかった

## ローストプラスで解決

これらの課題を解決するため、ローストプラスでは以下の機能を実装しました：

- **ランダムシャッフル**: 予測できないランダムな組み合わせを生成
- **公平性の担保**: 誰かに偏ることなく、平等に担当を割り振る仕組み

マンネリ化した担当表を解決するアプリとして開発がスタートしました。`,
    tags: ['開発背景', 'コンセプト', '担当表'],
    publishedAt: '2026-01-16',
    order: 1,
  },
  {
    id: 'episode-002',
    title: 'バイブコーディングとは？',
    subtitle: 'AIと一緒にアプリを作る新しい方法',
    imageUrl: '/dev-stories/vibe_coding.png',
    dialogues: [
      {
        id: 'msg-002-1',
        characterId: 'asairi',
        content: '「バイブコーディング」って最近聞くけど、何のこと？',
      },
      {
        id: 'msg-002-2',
        characterId: 'fukairi',
        content: 'AIと会話しながらアプリを作る新しい方法だよ。',
      },
      {
        id: 'msg-002-3',
        characterId: 'asairi',
        content: '会話でアプリが作れるってどういうこと？魔法みたい！',
      },
      {
        id: 'msg-002-4',
        characterId: 'fukairi',
        content: '「こんな機能が欲しい」って言葉で伝えると、AIがプログラムのコードを書いてくれるんだ。',
      },
      {
        id: 'msg-002-5',
        characterId: 'asairi',
        content: 'えっ、プログラミング言語を覚えなくてもいいの？',
      },
      {
        id: 'msg-002-6',
        characterId: 'fukairi',
        content: 'そうなんだ。だから「バイブ」＝雰囲気やイメージで伝えるっていう意味なんだよ。',
      },
      {
        id: 'msg-002-7',
        characterId: 'asairi',
        content: 'へー！このローストプラスもそうやって作ったの？',
      },
      {
        id: 'msg-002-8',
        characterId: 'fukairi',
        content: '実はローストプラスは、ほぼ全部バイブコーディングで作ったんだよ。',
      },
      {
        id: 'msg-002-9',
        characterId: 'asairi',
        content: 'えっ、このアプリ全部！？信じられない！',
      },
      {
        id: 'msg-002-10',
        characterId: 'fukairi',
        content: '「担当表をシャッフルする機能が欲しい」みたいに伝えるだけで、形になっていくんだ。',
      },
      {
        id: 'msg-002-11',
        characterId: 'asairi',
        content: 'どんなAIツールを使ってるの？',
      },
      {
        id: 'msg-002-12',
        characterId: 'fukairi',
        content: 'メインはCursorっていうツールで、他にもCodex、Antigravity、最近はClaude Codeにも挑戦中なんだ。',
      },
      {
        id: 'msg-002-13',
        characterId: 'asairi',
        content: 'そんなにたくさん！使い分けてるの？',
      },
      {
        id: 'msg-002-14',
        characterId: 'fukairi',
        content: 'うん。ツールによって得意なことが違うから、場面に合わせて選んでるよ。',
      },
      {
        id: 'msg-002-15',
        characterId: 'asairi',
        content: 'すごい便利そう！でも難しいこともある？',
      },
      {
        id: 'msg-002-16',
        characterId: 'fukairi',
        content: 'あるよ。AIに意図を正確に伝えるのが難しいし、思った通りにならないことも多い。\n何度もやり直す根気が必要なんだ。',
      },
      {
        id: 'msg-002-17',
        characterId: 'fukairi',
        content: 'あと、AIが書いたコードを理解せずに使うと、セキュリティの問題が起きることもある。\n注意が必要だよ。',
      },
      {
        id: 'msg-002-18',
        characterId: 'asairi',
        content: 'なるほど！便利だけど、ちゃんと向き合う姿勢が大事なんだね。',
      },
      {
        id: 'msg-002-19',
        characterId: 'fukairi',
        content: 'そうだね。でも挑戦する価値は十分あると思うよ！\nアイデアを形にする敷居がぐっと下がったからね。',
      },
    ],
    detailContent: `バイブコーディングは、AIとの対話でアプリを作る新しいプログラミング手法です。

## バイブコーディングとは

**バイブコーディング**とは、プログラミング言語を使わず、自然な言葉でAIに「こんな機能が欲しい」と伝えてコードを生成してもらう開発方法です。

「バイブ（Vibe）」は英語で「雰囲気」や「感覚」という意味。細かい技術的な指示ではなく、**やりたいことのイメージを伝えるだけ**でアプリが作れることから、この名前がつきました。

## 従来のプログラミングとの違い

| 従来のプログラミング | バイブコーディング |
|---------------------|-------------------|
| プログラミング言語を習得する必要がある | 自然な言葉で伝えるだけ |
| コードを1行ずつ書く | AIがコードを生成 |
| エラーを自分で解決 | AIと一緒に解決 |
| 学習に長い時間がかかる | すぐに始められる |

## メリット

- **プログラミング経験がなくてもアプリが作れる**
- **アイデアを素早く形にできる**
- **試行錯誤のスピードが格段に上がる**

## ローストプラスで使っているAIツール

| ツール | 特徴 | このアプリでの使い方 |
|--------|------|---------------------|
| **Cursor** | AIエディタのパイオニア | メインの開発ツールとして日常的に使用 |
| **Codex** | OpenAI製・高い推論力 | 複雑なバックエンド機能の修正 |
| **Antigravity** | 最新のAI系IDE | フロントエンド改善、シャッフルロジック改善 |
| **Claude Code** | ターミナルベースの対話型 | 最近挑戦中の新しいツール |

それぞれのツールには得意分野があり、場面に合わせて使い分けています。

## デメリット・注意点

バイブコーディングは便利ですが、難しさや注意点もあります：

- **適切な指示を出す難しさ**: AIに意図を正確に伝えるスキルが必要
- **根気が必要**: 思い通りにならないことも多く、何度もやり直すことがある
- **評価力が必要**: AIの提案が正しいかどうか判断する力が求められる
- **セキュリティリスク**: 理解せずにコードを採用すると、危険な場合がある

**大切なのは、AIに任せきりにせず、一緒に作っていく姿勢です。**

## このアプリでの実例

ローストプラスでは、以下の機能がバイブコーディングで作られました：

- 担当表シャッフル機能
- 試飲感想記録機能
- この「開発秘話」ページ自体も！

非エンジニアでも、アイデアがあれば形にできる時代になりました。`,
    tags: ['バイブコーディング', 'AI', '開発手法'],
    publishedAt: '2026-01-16',
    order: 2,
  },
  {
    id: 'episode-003',
    title: 'ローストプラスは一度作り直している',
    imageUrl: '/dev-stories/roast_plus_origin.png',
    dialogues: [
      {
        id: 'msg-003-1',
        characterId: 'asairi',
        content: 'ローストプラスって、最初はFlutterで作られてたんですよね？',
      },
      {
        id: 'msg-003-2',
        characterId: 'fukairi',
        content: 'そうだね。Flutterっていうのは、1つのコードでiPhoneとAndroid両方のアプリが作れるフレームワーク（開発ツール）なんだ。',
      },
      {
        id: 'msg-003-3',
        characterId: 'asairi',
        content: 'すごい便利そう！でも今はFlutterじゃないんでしょ？',
      },
      {
        id: 'msg-003-4',
        characterId: 'fukairi',
        content: 'うん、実は本番環境で大きな問題が起きてね...\nログインがうまくいかなくなったんだ。',
      },
      {
        id: 'msg-003-5',
        characterId: 'asairi',
        content: 'えっ、ログインできなくなっちゃったの？',
      },
      {
        id: 'msg-003-6',
        characterId: 'fukairi',
        content: 'そうなんだ。開発中のテスト環境では動いてたのに、実際にユーザーが使う本番環境では動かなくなっちゃって...',
      },
      {
        id: 'msg-003-7',
        characterId: 'asairi',
        content: 'それは困る！原因はわかったの？',
      },
      {
        id: 'msg-003-8',
        characterId: 'fukairi',
        content: '正直、完全には特定できなかったんだ。\n何度も修正を試みたけど、直してもまた別の問題が出てきて...',
      },
      {
        id: 'msg-003-9',
        characterId: 'asairi',
        content: 'もぐらたたきみたいな状態だったんだね。',
      },
      {
        id: 'msg-003-10',
        characterId: 'fukairi',
        content: 'まさにそう！\nFlutterとFirebase（データを保存するサービス）の認証の組み合わせが複雑で、どこで問題が起きてるか追跡しづらかったんだ。',
      },
      {
        id: 'msg-003-11',
        characterId: 'asairi',
        content: 'それで作り直すことにしたの？',
      },
      {
        id: 'msg-003-12',
        characterId: 'fukairi',
        content: 'うん。修正し続けるより、最初から作り直した方が早いし確実だと判断したんだ。\nこれは苦渋の決断だったけどね。',
      },
      {
        id: 'msg-003-13',
        characterId: 'asairi',
        content: '新しく選んだNext.jsって何？',
      },
      {
        id: 'msg-003-14',
        characterId: 'fukairi',
        content: 'Next.jsは、ウェブアプリを作るためのフレームワークだよ。\nReact（リアクト）っていう有名な技術をベースにしてるんだ。',
      },
      {
        id: 'msg-003-15',
        characterId: 'asairi',
        content: 'なんでFlutterじゃなくてNext.jsにしたの？',
      },
      {
        id: 'msg-003-16',
        characterId: 'fukairi',
        content: 'いくつか理由があるんだ。\nまず、ウェブ技術の方が情報が多くて、問題が起きても解決しやすい。',
      },
      {
        id: 'msg-003-17',
        characterId: 'fukairi',
        content: 'それと、Flutterはアプリストアからダウンロードが必要だけど、ウェブアプリならURLにアクセスするだけで使えるんだ。',
      },
      {
        id: 'msg-003-18',
        characterId: 'asairi',
        content: 'あ、確かに！アプリをダウンロードしなくていいのは楽だね。',
      },
      {
        id: 'msg-003-19',
        characterId: 'fukairi',
        content: 'あと、Next.jsとFirebaseの組み合わせは認証の仕組みがシンプルで、トラブルが起きにくいんだよ。',
      },
      {
        id: 'msg-003-20',
        characterId: 'asairi',
        content: '他にも選択肢はあったの？',
      },
      {
        id: 'msg-003-21',
        characterId: 'fukairi',
        content: 'もちろん！React Native（リアクトネイティブ）とか、Flutter Webとか色々検討したよ。\nでも、ローストプラスの使い方を考えると、ウェブアプリが一番合ってたんだ。',
      },
      {
        id: 'msg-003-22',
        characterId: 'asairi',
        content: 'ユーザーにとって何が変わったの？',
      },
      {
        id: 'msg-003-23',
        characterId: 'fukairi',
        content: 'まず、ログインが安定したよ！\n以前みたいに「あれ、ログインできない...」っていうストレスがなくなった。',
      },
      {
        id: 'msg-003-24',
        characterId: 'asairi',
        content: 'それは大事！他には？',
      },
      {
        id: 'msg-003-25',
        characterId: 'fukairi',
        content: 'ページの読み込みも速くなったよ。\nNext.jsは表示速度の最適化が得意なフレームワークなんだ。',
      },
      {
        id: 'msg-003-26',
        characterId: 'asairi',
        content: 'でも、作り直すのは大変だったよね？',
      },
      {
        id: 'msg-003-27',
        characterId: 'fukairi',
        content: '正直、かなり大変だった。\n一からデザインを考え直して、機能も全部実装し直したからね。',
      },
      {
        id: 'msg-003-28',
        characterId: 'fukairi',
        content: 'でも、バイブコーディングのおかげで思ったより早く形になったんだ。\nAIと一緒に開発できる時代でよかった。',
      },
      {
        id: 'msg-003-29',
        characterId: 'asairi',
        content: 'この失敗から学んだことってある？',
      },
      {
        id: 'msg-003-30',
        characterId: 'fukairi',
        content: 'たくさんあるよ。\nまず、本番環境でのテストをもっと早い段階でやるべきだった。',
      },
      {
        id: 'msg-003-31',
        characterId: 'fukairi',
        content: 'それと、技術選定は「作りやすさ」だけじゃなく「問題が起きたときの対処しやすさ」も大事だって学んだ。',
      },
      {
        id: 'msg-003-32',
        characterId: 'asairi',
        content: 'なるほど〜！失敗も次に活かせてるんだね。',
      },
      {
        id: 'msg-003-33',
        characterId: 'fukairi',
        content: 'うん。ユーザーの皆さんには迷惑をかけてしまって申し訳なかったけど、結果的により良いアプリになったと思う。',
      },
      {
        id: 'msg-003-34',
        characterId: 'asairi',
        content: '素直に失敗を認めて、ちゃんと改善したのは偉いと思う！',
      },
      {
        id: 'msg-003-35',
        characterId: 'fukairi',
        content: 'ありがとう。これからも安定して使えるアプリを目指して頑張るよ！\n使ってくれるみんなに感謝だね。',
      },
    ],
    detailContent: `ローストプラスは、一度Flutterで開発した後、Next.jsで作り直しています。この記事では、その背景と経緯を詳しく説明します。

## Flutterで何が起きたのか

### 本番環境でのログイン問題

Flutterで開発したアプリをリリースした後、**本番環境でログインができなくなる問題**が発生しました。

- 開発中のテスト環境では正常に動作していた
- 実際のユーザーが使う本番環境でのみ問題が発生
- ログイン処理が途中で止まったり、認証状態が保持されなかったりした

### 原因の特定困難性

問題の根本原因を完全に特定することはできませんでした。考えられる要因として：

- FlutterとFirebase Authenticationの複雑な連携
- 本番環境と開発環境の微妙な設定差異
- 認証状態の管理に関する複数のレイヤー

**何度も修正を試みましたが、1つ直すと別の問題が発生するという「もぐらたたき」状態**に陥りました。

## なぜNext.jsを選んだのか

### フレームワーク選定の理由

| 比較項目 | Flutter | Next.js |
|----------|---------|---------|
| **情報量** | 比較的少ない | 非常に多い |
| **認証連携** | 複雑 | シンプル |
| **インストール** | アプリストア経由 | URL直接アクセス |
| **更新反映** | ストア審査が必要 | 即時反映可能 |
| **デバッグ** | やや困難 | ブラウザで容易 |

### 他の選択肢との比較

以下のフレームワークも検討しました：

- **React Native**: アプリ形式を維持できるが、同様の認証問題リスク
- **Flutter Web**: ウェブ対応だが、モバイル向け設計が影響
- **Vue.js / Nuxt**: 良い選択肢だが、エコシステムの規模でNext.jsを選択

**ローストプラスの主な使用シーン（店舗での利用）を考慮し、インストール不要なウェブアプリが最適と判断**しました。

### 作り直しの決断

修正を続けるか、作り直すかの判断基準：

- ✅ 修正の見通しが立たない
- ✅ 根本原因が特定できない
- ✅ 同じフレームワークを使い続けるリスク
- ✅ 新しい技術でより良い設計が可能

これらの理由から、**一から作り直す判断**に至りました。

## ユーザーへの影響

### 改善されたポイント

- **ログインの安定性**: 認証処理がシンプルになり、ログイン問題が解消
- **読み込み速度**: Next.jsの最適化により、ページ表示が高速化
- **アクセス性**: ブラウザから直接アクセス可能（アプリダウンロード不要）
- **更新の即時反映**: 機能追加や修正がすぐにユーザーに届く

### ユーザーが気付く変化

- URLにアクセスするだけで使える
- ログイン時のエラーや待ち時間が減少
- 画面遷移がスムーズに

## 失敗から学んだこと

### 1. 早期の本番テスト

開発の後半になってから本番環境でテストするのではなく、**早い段階で実際の環境に近い形で検証する**ことの重要性を学びました。

開発中のテスト環境では問題なく動いていたため、本番環境特有の問題に気付くのが遅れました。もっと早い段階で本番環境に近い条件でテストしていれば、問題を早期に発見し、対処する時間を確保できたはずです。

### 2. 技術選定の視点

フレームワークやツールを選ぶとき、「作りやすさ」だけでなく**「問題が起きたときの対処しやすさ」**も重要な判断基準だと実感しました。

- **情報の多さ**: 困ったときにネットで解決策が見つかるか
- **コミュニティの活発さ**: 同じ問題に遭遇した人がいるか
- **デバッグのしやすさ**: エラーの原因を追跡できる仕組みがあるか

どんな技術にも長所・短所がありますが、トラブル発生時にどれだけ対処しやすいかは、プロジェクトの成功に大きく影響します。

### 3. 損切りの判断

修正を続けることと、作り直すことの**判断タイミング**を見極める重要性を学びました。

「もう少し頑張れば直るかも」という思いで修正を続けがちですが、根本原因が不明なまま対症療法を繰り返すと、かえって時間を浪費することがあります。

作り直すという決断は勇気がいりますが、結果的にはより早く、より良いものを作ることにつながりました。

## ユーザーへの感謝

Flutterバージョンで不便をおかけしたユーザーの皆様には、心よりお詫び申し上げます。

この経験を糧に、より安定したサービスを提供できるよう努めていきます。引き続きローストプラスをよろしくお願いいたします。`,
    tags: ['開発背景'],
    publishedAt: '2026-01-17',
    order: 3,
  },
];

// エピソードをIDで取得
export const getEpisodeById = (id: string): DevStoryEpisode | undefined => {
  return DEV_STORY_EPISODES.find((episode) => episode.id === id);
};

// エピソードを表示順序でソート
export const getSortedEpisodes = (): DevStoryEpisode[] => {
  return [...DEV_STORY_EPISODES].sort((a, b) => a.order - b.order);
};
